<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>功能测试 - 汉中旅游</title>
    <link rel="stylesheet" href="css/common.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            background: #f8f9fa;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo h1 {
            margin: 0;
            font-size: 24px;
        }
        
        .user-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            text-decoration: none;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .btn-primary:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .test-section {
            padding: 60px 0;
            margin-bottom: 20px;
        }
        
        .test-section:nth-child(even) {
            background: white;
        }
        
        .section-title {
            text-align: center;
            font-size: 32px;
            margin-bottom: 20px;
            color: #333;
        }
        
        .section-desc {
            text-align: center;
            font-size: 16px;
            color: #666;
            margin-bottom: 40px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .test-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .test-card:hover {
            transform: translateY(-5px);
        }
        
        .test-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .test-card h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .test-card p {
            color: #666;
            margin-bottom: 20px;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-test {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-test:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 2000;
            min-width: 200px;
        }
        
        .status-item {
            margin-bottom: 5px;
        }
        
        .status-ok {
            color: #4CAF50;
        }
        
        .status-error {
            color: #f44336;
        }
    </style>
</head>
<body>
    <div class="status-indicator" id="statusIndicator">
        <div class="status-item">滚动位置: <span id="scrollPos">0</span>px</div>
        <div class="status-item">按钮状态: <span id="buttonStatus">检查中...</span></div>
        <div class="status-item">用户状态: <span id="userStatus">未登录</span></div>
    </div>

    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1>🏛️ 汉中旅游测试</h1>
                </div>
                <div class="user-actions" id="userActions">
                    <a href="register.html" class="btn btn-primary">注册</a>
                    <a href="login.html" class="btn btn-primary">登录</a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="test-section">
            <div class="container">
                <h2 class="section-title">🔧 功能修复验证</h2>
                <p class="section-desc">验证所有已修复的功能是否正常工作</p>
                
                <div class="test-grid">
                    <div class="test-card">
                        <div class="test-icon">🔄</div>
                        <h3>回到顶部按钮</h3>
                        <p>向下滚动超过300px后，右下角应该出现回到顶部按钮</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="testScrollDown()">滚动到底部</button>
                            <button class="btn-test" onclick="testScrollTop()">回到顶部</button>
                        </div>
                    </div>
                    
                    <div class="test-card">
                        <div class="test-icon">⭐</div>
                        <h3>收藏夹功能</h3>
                        <p>收藏夹按钮应该在回到顶部按钮上方显示</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="testFavorites()">打开收藏夹</button>
                            <button class="btn-test" onclick="testAddFavorite()">添加测试收藏</button>
                        </div>
                    </div>
                    
                    <div class="test-card">
                        <div class="test-icon">🍜</div>
                        <h3>美食收藏按钮</h3>
                        <p>所有美食项都应该有收藏按钮</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="window.open('meishi.html', '_blank')">查看美食页面</button>
                        </div>
                    </div>
                    
                    <div class="test-card">
                        <div class="test-icon">👤</div>
                        <h3>用户登录状态</h3>
                        <p>登录后用户信息应该在所有页面显示</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="window.open('login.html', '_blank')">登录测试</button>
                            <button class="btn-test" onclick="testLogout()">退出登录</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="test-section">
            <div class="container">
                <h2 class="section-title">📱 页面链接测试</h2>
                <p class="section-desc">测试各个页面的功能是否正常</p>
                
                <div class="test-grid">
                    <div class="test-card">
                        <div class="test-icon">🏛️</div>
                        <h3>景点页面</h3>
                        <p>测试景点收藏功能</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="window.open('jingdian.html', '_blank')">打开景点页面</button>
                        </div>
                    </div>
                    
                    <div class="test-card">
                        <div class="test-icon">🍜</div>
                        <h3>美食页面</h3>
                        <p>测试美食收藏功能</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="window.open('meishi.html', '_blank')">打开美食页面</button>
                        </div>
                    </div>
                    
                    <div class="test-card">
                        <div class="test-icon">🎭</div>
                        <h3>文化页面</h3>
                        <p>测试文化活动收藏功能</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="window.open('wenhua.html', '_blank')">打开文化页面</button>
                        </div>
                    </div>
                    
                    <div class="test-card">
                        <div class="test-icon">📝</div>
                        <h3>注册登录</h3>
                        <p>测试用户注册和登录功能</p>
                        <div class="test-buttons">
                            <button class="btn-test" onclick="window.open('register.html', '_blank')">注册页面</button>
                            <button class="btn-test" onclick="window.open('login.html', '_blank')">登录页面</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 添加更多内容以便测试滚动 -->
        <section class="test-section">
            <div class="container">
                <h2 class="section-title">📊 测试结果</h2>
                <p class="section-desc">以下是各项功能的测试状态</p>
                
                <div style="height: 200vh; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                    <h3>滚动测试区域</h3>
                    <p>继续向下滚动测试按钮显示功能</p>
                    <p>当滚动位置超过300px时，右下角的按钮应该显示</p>
                    <p>包括收藏夹按钮和回到顶部按钮</p>
                </div>
            </div>
        </section>
    </main>

    <script src="js/common.js"></script>
    <script>
        // 测试函数
        function testScrollDown() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        }
        
        function testScrollTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        function testFavorites() {
            if (typeof showFavoritesModal === 'function') {
                showFavoritesModal();
            } else {
                alert('收藏夹功能未加载');
            }
        }
        
        function testAddFavorite() {
            if (typeof addToFavorites === 'function') {
                const testItem = {
                    id: 'test-item',
                    type: 'attraction',
                    title: '测试景点',
                    description: '这是一个测试用的景点项目',
                    image: 'img/default-image.jpg',
                    rating: '4.5',
                    price: '免费',
                    url: '#test'
                };
                addToFavorites(testItem);
                alert('测试收藏项已添加');
            } else {
                alert('收藏功能未加载');
            }
        }
        
        function testLogout() {
            if (typeof handleGlobalLogout === 'function') {
                handleGlobalLogout();
            } else {
                alert('退出功能未加载');
            }
        }
        
        // 状态监控
        function updateStatus() {
            const scrollPos = window.pageYOffset || document.documentElement.scrollTop;
            document.getElementById('scrollPos').textContent = Math.round(scrollPos);
            
            const favBtn = document.querySelector('.favorites-btn');
            const backBtn = document.querySelector('.back-to-top');
            
            let buttonStatus = '未创建';
            if (favBtn && backBtn) {
                const favVisible = favBtn.classList.contains('show');
                const backVisible = backBtn.classList.contains('show');
                buttonStatus = `收藏夹:${favVisible ? '✅' : '❌'} 回顶部:${backVisible ? '✅' : '❌'}`;
            }
            
            document.getElementById('buttonStatus').innerHTML = buttonStatus;
            
            // 检查用户状态
            const userData = getGlobalUserData();
            const userStatus = userData ? `已登录: ${userData.username}` : '未登录';
            document.getElementById('userStatus').textContent = userStatus;
        }
        
        // 定期更新状态
        setInterval(updateStatus, 500);
        
        // 滚动监听
        window.addEventListener('scroll', updateStatus);
        
        // 页面加载完成
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(updateStatus, 1000);
        });
    </script>
</body>
</html> 